# HNSW & TOS Vectors 分层向量存储演示

这是一个交互式网页演示，展示了 HNSW（Hierarchical Navigable Small World）索引和 TOS Vector Bucket 的分层向量存储架构。

## 功能特性

### 1. HNSW 索引（内存层）
- 实时向量插入和索引构建
- 可视化图结构展示节点和邻居关系
- 支持单个或批量插入 4 维向量
- 点击节点查看向量详细信息
- 拖拽节点调整布局

### 2. TOS Vector Bucket（持久化层）
- 自动 Flush 机制：每 60 秒检查一次
- 将超过 5 分钟的向量从 HNSW 迁移到 TOS
- 使用 `putVectors` 接口创建时间戳索引
- 可视化展示所有归档索引

### 3. 智能查询路由
- 根据查询时间自动选择查询路径
- 5 分钟内的查询 → HNSW 索引（内存层）
- 5 分钟前的查询 → TOS Vector Bucket（持久化层）
- 使用 `queryVectors` 接口查询归档数据
- 返回 Top 5 最近邻结果

### 4. AWS 控制台风格界面
- 专业的 AWS 风格设计
- 实时统计信息展示
- 动画效果和交互反馈
- 响应式布局

## 使用方法

### 启动演示

1. 直接在浏览器中打开 `index.html` 文件
2. 无需后端服务器，纯前端实现

### 操作指南

#### 插入向量
- **插入随机向量**：点击按钮插入一个随机的 4 维向量到 HNSW 索引
- **批量插入**：一次性插入 10 个随机向量

#### 查看图结构
- 在 HNSW 图中，每个节点代表一个向量
- 连线表示向量之间的邻居关系
- 点击节点查看详细信息（ID、向量值、时间戳、邻居等）
- 拖拽节点可以调整布局

#### Flush 操作
- **自动 Flush**：系统每 60 秒自动检查并 Flush 超过 5 分钟的向量
- **手动 Flush**：点击"手动 Flush 到 TOS"按钮立即执行
- Flush 后的向量会出现在 TOS Vector Bucket 区域

#### 查询向量
1. 输入 4 维查询向量，例如：`0.5, 0.3, 0.8, 0.2`
2. 设置时间偏移（分钟）：
   - 0-4 分钟：查询 HNSW 索引
   - 5 分钟以上：查询 TOS Vector Bucket
3. 点击"执行查询"查看结果

## 技术架构

### 前端技术栈
- **HTML5 + CSS3**：页面结构和样式
- **JavaScript (ES6+)**：核心逻辑实现
- **D3.js v7**：图形可视化和力导向布局

### 核心算法
- **HNSW 索引**：基于图的近似最近邻搜索
- **欧氏距离**：向量相似度计算
- **力导向布局**：图结构可视化

### 数据流
```
插入向量 → HNSW 索引（内存）
    ↓ (5分钟后)
自动 Flush → putVectors → TOS Vector Bucket（持久化）
    ↓
查询路由 → HNSW 或 queryVectors → 返回结果
```

## 文件结构

```
.
├── index.html      # 主页面结构
├── styles.css      # AWS 风格样式
├── app.js          # 核心逻辑和可视化
└── readme.md       # 说明文档
```

## 演示场景

### 场景 1：实时数据查询
1. 插入多个向量到 HNSW
2. 立即查询（时间偏移 0 分钟）
3. 系统从 HNSW 索引返回结果

### 场景 2：历史数据查询
1. 等待向量被 Flush 到 TOS（或手动 Flush）
2. 查询历史数据（时间偏移 > 5 分钟）
3. 系统从 TOS Vector Bucket 返回结果

### 场景 3：混合查询
1. 系统同时包含新旧数据
2. 根据查询时间自动路由到正确的存储层
3. 展示分层存储的优势

## 注意事项

- 向量维度固定为 4 维
- HNSW 最大连接数为 5
- Flush 阈值为 5 分钟
- 自动 Flush 间隔为 60 秒
- 查询返回 Top 5 最近邻

## 浏览器兼容性

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 许可证

MIT License
